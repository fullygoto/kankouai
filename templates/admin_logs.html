<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>質問・回答ログ（直近最大300件）</title>
<style>
  body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","メイリオ",sans-serif;background:#f7faf9;margin:0}
  .wrap{max-width:1200px;margin:28px auto;padding:0 16px}
  h1{margin:0 0 14px;font-size:20px}
  table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 4px 16px #c6d4e71a}
  th,td{border-bottom:1px solid #e5e7eb;padding:10px;vertical-align:top;font-size:13px}
  th{background:#f1f5f9;text-align:left;white-space:nowrap}
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
  .badge{display:inline-block;padding:2px 8px;border-radius:999px;font-size:12px}
  .ok{background:#e6f7ef;color:#037a4a}
  .ng{background:#fde8ec;color:#b8143b}
  .src{color:#64748b}
  details>summary{cursor:pointer;color:#2563eb}
  .q{white-space:pre-wrap}
  .a{white-space:pre-wrap}
</style>
</head>
<body>
<div class="wrap">
  <h1>質問・回答ログ（直近最大300件）</h1>
  <table>
    <thead>
      <tr>
        <th style="width:170px;">時刻</th>
        <th style="width:80px;">ソース</th>
        <th style="width:90px;">ヒット</th>
        <th>質問</th>
        <th>回答</th>
      </tr>
    </thead>
    <tbody>
      {% for r in logs %}
      <tr>
        <td class="mono">{{ r.timestamp }}</td>
        <td class="src mono">{{ r.source or '' }}</td>
        <td>
          {% if r.hit_db %}
            <span class="badge ok">ヒット</span>
          {% else %}
            <span class="badge ng">未登録</span>
          {% endif %}
        </td>
        <td class="q">{{ r.question or '' }}</td>
        <td class="a">
          {% set ans = r.answer or '' %}
          {% if ans|length > 140 %}
            <details>
              <summary>開く</summary>
              <div style="margin-top:6px;">{{ ans }}</div>
            </details>
          {% else %}
            {{ ans }}
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
</body>
</html>
